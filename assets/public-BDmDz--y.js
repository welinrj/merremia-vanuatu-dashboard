import{j as a,f as p,M as u,A as N,r as l,l as v,m as g,g as f,H as y,k as D}from"./App-NfJZ_7BI.js";const P=[{id:"datasets",label:"Datasets"},{id:"about",label:"About"}],S="/merremia-vanuatu-dashboard/app.html",C=({activeSection:s,onNavigate:t})=>a.jsxs("aside",{className:"sidebar public-sidebar",children:[a.jsxs("div",{className:"sidebar-header",children:[a.jsx("h2",{children:"VCAP2"}),a.jsx("span",{className:"sidebar-subtitle",children:"Public Portal"})]}),a.jsx("nav",{className:"sidebar-nav",children:a.jsx("ul",{children:P.map(e=>a.jsx("li",{children:a.jsx("button",{className:`nav-item ${s===e.id?"active":""}`,onClick:()=>t(e.id),children:e.label})},e.id))})}),a.jsxs("div",{className:"sidebar-footer",children:[a.jsx("span",{className:"public-badge",children:"Read-Only Access"}),a.jsx("a",{href:S,className:"nav-item public-portal-link",target:"_blank",rel:"noopener noreferrer",children:"Staff Login →"})]})]}),w=({datasets:s,onView:t})=>a.jsx("div",{className:"table-container",children:a.jsxs("table",{className:"data-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Format"}),a.jsx("th",{children:"Features"}),a.jsx("th",{children:"Size"}),a.jsx("th",{children:"Updated"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:s.map(e=>a.jsxs("tr",{children:[a.jsxs("td",{children:[a.jsx("button",{className:"link-button",onClick:()=>t(e.id),children:e.metadata.name}),e.metadata.description&&a.jsx("span",{className:"dataset-description",children:e.metadata.description})]}),a.jsx("td",{children:a.jsx("span",{className:"badge badge-format",children:e.format.toUpperCase()})}),a.jsx("td",{children:e.featureCount.toLocaleString()}),a.jsx("td",{children:p(e.sizeBytes)}),a.jsx("td",{children:new Date(e.updatedAt).toLocaleDateString()}),a.jsx("td",{children:a.jsx("div",{className:"action-buttons",children:a.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>t(e.id),title:"View dataset on map",children:"View on Map"})})})]},e.id))})]})}),k=({dataset:s,onBack:t})=>{const{metadata:e,data:c,properties:r}=s;function o(){const i=JSON.stringify(c,null,2),m=new Blob([i],{type:"application/geo+json"}),n=URL.createObjectURL(m),d=document.createElement("a");d.href=n,d.download=`${e.name.replace(/\s+/g,"_")}.geojson`,d.click(),URL.revokeObjectURL(n)}return a.jsxs("div",{className:"dataset-detail",children:[a.jsxs("div",{className:"detail-header",children:[a.jsx("button",{className:"btn btn-sm",onClick:t,children:"← Back to Datasets"}),a.jsx("div",{className:"detail-actions",children:a.jsx("button",{className:"btn btn-sm btn-primary",onClick:o,children:"Download GeoJSON"})})]}),a.jsxs("div",{className:"detail-meta-card",children:[a.jsxs("div",{className:"detail-title-row",children:[a.jsx("h2",{children:e.name}),a.jsx("span",{className:"badge badge-active",children:"Published"})]}),e.description&&a.jsx("p",{className:"detail-description",children:e.description}),a.jsxs("div",{className:"detail-stats",children:[a.jsxs("div",{className:"detail-stat",children:[a.jsx("span",{className:"detail-stat-label",children:"Format"}),a.jsx("span",{className:"detail-stat-value",children:s.format.toUpperCase()})]}),a.jsxs("div",{className:"detail-stat",children:[a.jsx("span",{className:"detail-stat-label",children:"Features"}),a.jsx("span",{className:"detail-stat-value",children:s.featureCount.toLocaleString()})]}),a.jsxs("div",{className:"detail-stat",children:[a.jsx("span",{className:"detail-stat-label",children:"Size"}),a.jsx("span",{className:"detail-stat-value",children:p(s.sizeBytes)})]}),a.jsxs("div",{className:"detail-stat",children:[a.jsx("span",{className:"detail-stat-label",children:"CRS"}),a.jsx("span",{className:"detail-stat-value",children:e.crs})]}),e.source&&a.jsxs("div",{className:"detail-stat",children:[a.jsx("span",{className:"detail-stat-label",children:"Source"}),a.jsx("span",{className:"detail-stat-value",children:e.source})]}),e.license&&a.jsxs("div",{className:"detail-stat",children:[a.jsx("span",{className:"detail-stat-label",children:"License"}),a.jsx("span",{className:"detail-stat-value",children:e.license})]})]}),e.tags.length>0&&a.jsx("div",{className:"detail-tags",children:e.tags.map(i=>a.jsx("span",{className:"badge badge-tag",children:i},i))}),s.bbox&&a.jsxs("div",{className:"detail-bbox",children:[a.jsx("span",{className:"detail-stat-label",children:"Bounding Box"}),a.jsxs("code",{children:["[",s.bbox.map(i=>i.toFixed(4)).join(", "),"]"]})]})]}),a.jsxs("div",{className:"detail-map",children:[a.jsx("h3",{children:"Map Preview"}),a.jsx(u,{data:c,height:"450px"})]}),a.jsx(N,{data:c,properties:r})]})},A=()=>{const[s,t]=l.useState("list"),[e,c]=l.useState([]),[r,o]=l.useState(null),[i,m]=l.useState(!0),[n,d]=l.useState(""),j=l.useCallback(async()=>{const x=await v();c(x.filter(h=>h.metadata.status==="active"))},[]);l.useEffect(()=>{g().then(()=>j()).catch(()=>d("Unable to load datasets. Please try refreshing the page.")).finally(()=>m(!1))},[j]);const b=l.useCallback(async x=>{const h=await f(x);h&&(o(h),t("detail"))},[]);return i?a.jsx("div",{className:"data-portal",children:a.jsx("div",{className:"portal-toolbar",children:a.jsxs("div",{className:"portal-toolbar-left",children:[a.jsx("h2",{children:"Published Datasets"}),a.jsx("span",{className:"dataset-count",children:"Loading..."})]})})}):a.jsxs("div",{className:"data-portal",children:[n&&a.jsx("div",{className:"form-error",role:"alert",children:n}),s==="list"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"portal-toolbar",children:[a.jsxs("div",{className:"portal-toolbar-left",children:[a.jsx("h2",{children:"Published Datasets"}),a.jsxs("span",{className:"dataset-count",children:[e.length," dataset",e.length!==1?"s":""," available"]})]}),a.jsx("div",{className:"portal-toolbar-right",children:a.jsx("span",{className:"public-read-only-badge",children:"Read-Only"})})]}),e.length===0&&!n?a.jsxs("div",{className:"portal-empty",children:[a.jsx("p",{children:"No published datasets available yet."}),a.jsx("p",{style:{fontSize:"0.85rem",marginTop:"0.5rem"},children:"Datasets will appear here once they are published by DEPC staff."})]}):a.jsx(w,{datasets:e,onView:b})]}),s==="detail"&&r&&a.jsx(k,{dataset:r,onBack:()=>{o(null),t("list")}})]})},L={datasets:"Datasets",about:"About"};function E(){const[s,t]=l.useState("datasets");return a.jsxs("div",{className:"app-layout",children:[a.jsx(C,{activeSection:s,onNavigate:t}),a.jsxs("main",{className:"main-content",children:[a.jsx(y,{title:L[s]??s}),a.jsxs("div",{className:"dashboard-content",children:[s==="datasets"&&a.jsx(A,{}),s==="about"&&a.jsxs("div",{className:"placeholder-section",children:[a.jsx("h3",{children:"VCAP2 Public Data Portal"}),a.jsx("p",{style:{marginTop:"0.75rem"},children:"This public portal provides read-only access to geospatial datasets published by the Vanuatu Climate Adaptation Project 2 (VCAP2) and the Department of Environmental Protection & Conservation (DEPC)."}),a.jsx("p",{style:{marginTop:"0.5rem",fontSize:"0.85rem"},children:"Datasets are uploaded and managed by authorized staff via the In-House Portal. The public can view, explore, and download datasets shared here."})]})]})]})]})}D.createRoot(document.getElementById("root")).render(a.jsx(l.StrictMode,{children:a.jsx(E,{})}));
