<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Merremia Vanuatu Dashboard</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #0f172a;
      color: #e2e8f0;
      min-height: 100vh;
    }
    header {
      background: linear-gradient(135deg, #065f46, #064e3b);
      padding: 1.5rem 2rem;
      border-bottom: 2px solid #10b981;
    }
    header h1 { font-size: 1.5rem; color: #ecfdf5; }
    header p { color: #6ee7b7; font-size: 0.875rem; margin-top: 0.25rem; }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 1rem;
      padding: 1.5rem 2rem;
    }
    .card {
      background: #1e293b;
      border-radius: 0.75rem;
      padding: 1.25rem;
      border: 1px solid #334155;
    }
    .card h3 {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #94a3b8;
      margin-bottom: 0.5rem;
    }
    .card .value {
      font-size: 2rem;
      font-weight: 700;
      color: #34d399;
    }
    .card .sub { font-size: 0.8rem; color: #64748b; margin-top: 0.25rem; }
    .main-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      padding: 0 2rem 1.5rem;
    }
    @media (max-width: 768px) { .main-grid { grid-template-columns: 1fr; } }
    .panel {
      background: #1e293b;
      border-radius: 0.75rem;
      padding: 1.25rem;
      border: 1px solid #334155;
    }
    .panel h2 {
      font-size: 1rem;
      color: #cbd5e1;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid #334155;
    }
    #map { height: 320px; border-radius: 0.5rem; }
    canvas { width: 100% !important; max-height: 300px; }
    table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
    th { text-align: left; color: #94a3b8; padding: 0.5rem; border-bottom: 1px solid #334155; }
    td { padding: 0.5rem; border-bottom: 1px solid #1e293b; }
    .badge {
      display: inline-block;
      padding: 0.15rem 0.5rem;
      border-radius: 9999px;
      font-size: 0.7rem;
      font-weight: 600;
    }
    .badge-high { background: #7f1d1d; color: #fca5a5; }
    .badge-moderate { background: #78350f; color: #fcd34d; }
    .badge-low { background: #064e3b; color: #6ee7b7; }
    footer {
      text-align: center;
      padding: 1rem;
      color: #475569;
      font-size: 0.75rem;
    }
  </style>
</head>
<body>
  <header>
    <h1>Merremia Vanuatu Dashboard</h1>
    <p>Invasive vine species monitoring across Vanuatu islands</p>
  </header>

  <div class="grid">
    <div class="card">
      <h3>Species Tracked</h3>
      <div class="value">7</div>
      <div class="sub">Merremia spp. identified</div>
    </div>
    <div class="card">
      <h3>Survey Sites</h3>
      <div class="value">34</div>
      <div class="sub">Across 6 islands</div>
    </div>
    <div class="card">
      <h3>Area Affected</h3>
      <div class="value">2,140 <span style="font-size:1rem">ha</span></div>
      <div class="sub">+12% from last survey</div>
    </div>
    <div class="card">
      <h3>Last Updated</h3>
      <div class="value" style="font-size:1.3rem" id="last-updated"></div>
      <div class="sub">Quarterly survey cycle</div>
    </div>
  </div>

  <div class="main-grid">
    <div class="panel">
      <h2>Distribution Map</h2>
      <div id="map"></div>
    </div>
    <div class="panel">
      <h2>Coverage by Island</h2>
      <canvas id="chart-islands"></canvas>
    </div>
    <div class="panel">
      <h2>Spread Over Time</h2>
      <canvas id="chart-trend"></canvas>
    </div>
    <div class="panel">
      <h2>Species Observations</h2>
      <table>
        <thead><tr><th>Species</th><th>Count</th><th>Threat</th></tr></thead>
        <tbody>
          <tr><td><em>M. peltata</em></td><td>482</td><td><span class="badge badge-high">High</span></td></tr>
          <tr><td><em>M. vitifolia</em></td><td>215</td><td><span class="badge badge-moderate">Moderate</span></td></tr>
          <tr><td><em>M. tridentata</em></td><td>167</td><td><span class="badge badge-moderate">Moderate</span></td></tr>
          <tr><td><em>M. gemella</em></td><td>98</td><td><span class="badge badge-low">Low</span></td></tr>
          <tr><td><em>M. umbellata</em></td><td>73</td><td><span class="badge badge-low">Low</span></td></tr>
          <tr><td><em>M. tuberosa</em></td><td>41</td><td><span class="badge badge-low">Low</span></td></tr>
          <tr><td><em>M. dissecta</em></td><td>29</td><td><span class="badge badge-low">Low</span></td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <footer>Merremia Vanuatu Dashboard &mdash; Ecological Monitoring Project</footer>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script>
    // Last updated date
    document.getElementById('last-updated').textContent = new Date().toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' });

    // Map
    const map = L.map('map').setView([-16.5, 167.8], 6);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors',
      maxZoom: 18
    }).addTo(map);

    const sites = [
      { name: 'Efate – Port Vila', lat: -17.7334, lng: 168.3273, count: 128, threat: 'High' },
      { name: 'Espiritu Santo – Luganville', lat: -15.5150, lng: 167.1750, count: 95, threat: 'High' },
      { name: 'Tanna – Lenakel', lat: -19.5214, lng: 169.2636, count: 72, threat: 'Moderate' },
      { name: 'Malakula – Lakatoro', lat: -16.1000, lng: 167.4167, count: 64, threat: 'Moderate' },
      { name: 'Ambae – Saratamata', lat: -15.3833, lng: 167.8333, count: 41, threat: 'Low' },
      { name: 'Erromango – Dillon Bay', lat: -18.8000, lng: 169.0333, count: 33, threat: 'Low' },
      { name: 'Pentecost – Melsisi', lat: -15.9000, lng: 168.1833, count: 52, threat: 'Moderate' },
      { name: 'Epi – Ringdove Bay', lat: -16.7333, lng: 168.1667, count: 28, threat: 'Low' },
    ];

    const threatColors = { High: '#ef4444', Moderate: '#f59e0b', Low: '#10b981' };
    sites.forEach(s => {
      L.circleMarker([s.lat, s.lng], {
        radius: Math.sqrt(s.count) * 1.5,
        color: threatColors[s.threat],
        fillColor: threatColors[s.threat],
        fillOpacity: 0.5,
        weight: 1
      }).addTo(map).bindPopup(`<strong>${s.name}</strong><br>${s.count} observations<br>Threat: ${s.threat}`);
    });

    // Chart colors
    const green = '#34d399';
    const gridColor = '#334155';
    Chart.defaults.color = '#94a3b8';

    // Bar chart – Coverage by island
    new Chart(document.getElementById('chart-islands'), {
      type: 'bar',
      data: {
        labels: ['Efate', 'Santo', 'Tanna', 'Malakula', 'Pentecost', 'Ambae', 'Erromango', 'Epi'],
        datasets: [{
          label: 'Area (ha)',
          data: [620, 480, 310, 275, 185, 120, 90, 60],
          backgroundColor: ['#ef4444','#ef4444','#f59e0b','#f59e0b','#10b981','#10b981','#10b981','#10b981'],
          borderRadius: 4
        }]
      },
      options: {
        responsive: true,
        plugins: { legend: { display: false } },
        scales: {
          x: { grid: { color: gridColor } },
          y: { grid: { color: gridColor }, title: { display: true, text: 'Hectares' } }
        }
      }
    });

    // Line chart – Spread trend
    new Chart(document.getElementById('chart-trend'), {
      type: 'line',
      data: {
        labels: ['2020 Q1','2020 Q3','2021 Q1','2021 Q3','2022 Q1','2022 Q3','2023 Q1','2023 Q3','2024 Q1','2024 Q3','2025 Q1','2025 Q3'],
        datasets: [{
          label: 'Total area (ha)',
          data: [820, 910, 1020, 1100, 1240, 1350, 1480, 1580, 1720, 1860, 1980, 2140],
          borderColor: green,
          backgroundColor: 'rgba(52,211,153,0.1)',
          fill: true,
          tension: 0.3,
          pointRadius: 3
        }]
      },
      options: {
        responsive: true,
        plugins: { legend: { display: false } },
        scales: {
          x: { grid: { color: gridColor } },
          y: { grid: { color: gridColor }, title: { display: true, text: 'Hectares' } }
        }
      }
    });
  </script>
</body>
</html>
